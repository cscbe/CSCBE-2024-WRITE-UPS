# Unbeatable Tic Tac Toe

## Category
Pwn

## Estimated difficulty
Medium

## Description
Unbeatable Tic Tac Toe AI, but the game has an implementation fault. The player can overwrite plays of the AI to create 3 in a row and win. Only when the player wins they encounter a vulnerable piece of the program. They can obtain a shell with a ret2csu or ret2dl_resolve exploit (or maybe some other more complex/creative method).

## Scenario
Tic Tac Toe is a solved game. No one can beat an AI with perfect play, right?

## Write-up
Running the binary shows a typical Tic Tac Toe board where the contestant can choose a location to play in first. Input is validated so that only digits between 1 and 9 can be supplied. After the contestant's play, the computer will play next. Since it uses a minimax algorithm with sufficient depth, it will have perfect play for Tic Tac Toe. This means the computer can always force a draw.

Loading the binary in a disassembler shows that a vulnerable function (gets) is called only if the player wins the game. To be able to exploit the binary, there must be a way to win. Playing around for a while or analyzing the disassembled code may lead to the discovery that the player moves are only checked to be between 1 and 9 with no previous player move at that location. It is however possible to play in a box where the computer has played, and overwrite this with a player's move. This mistake in the implementation means you can easily get three in a row, even though the computer has perfect play.

Once you win Tic Tac Toe, you hit a `gets` call, vulnerable to a buffer overflow. The binary has no canary nor is pie enabled. It can thus be solved for example using a ret2csu (see solve script) or a ret2dl_resolve exploit.
Don't forget to link the binary to the provided libc before writing your exploit. An easy way to do this is using the tool [pwninit](https://github.com/io12/pwninit).

## Solve script
./Resources/solve.py

## Flag
CSC{N0t_sO_Unb3at4ble_Aft3r_All!}

## Creator
Alex Van Mechelen

## Creator bio
Alex is a master student polytechnics at the Royal Military Academy. He is former contestant from the teams Royal Military Hackademy & DIG174L. He hopes you'll have a great time solving his challenges!